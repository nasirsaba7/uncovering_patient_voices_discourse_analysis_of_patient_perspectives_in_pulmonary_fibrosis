import string
from nltk.corpus import stopwords
from nltk.tokenize import word_tokenize
from nltk.stem import WordNetLemmatizer
from gensim.corpora.dictionary import Dictionary
from gensim.models.ldamodel import LdaModel

# Sample text
documents = [
"I hope my participation in the [Pulmonary Fibrosis Foundation] Registry can ultimately help other patients understand and plan for what their disease may bring. How do you learn to live a fairly productive life when you have a progressive disease and there is no playbook on what to expect? By filling out quality-of-life questionnaires for the Registry, I want to provide enough data points so that healthcare providers can help their patients work through their struggles. Nevertheless, questions remained, and one of them was worrisome enough to get people to consider an unconventional approach to follow-up research. The problem is that the results that come out of drug studies in mice almost never translate to humans  As a result, we have close to thirty failed drug trials in pulmonary fibrosis alone. I take part in every research study I can  Maybe that information will not help me, but it may help someone else, maybe my children or grandchildren. Now for the pulmonologist, the breathing is that big target because it is a measurable thing, but for me the improvement, the quality of life is, can I walk upstairs better, can I perform things better, can I take a shower and put on clothes at the same time within the same hour? Those are things that are important to me. I struggle with the pulmonary function tests just as my illness progresses the pulmonary function tests become more and more challenging   It would be great if   somebody could ... come up with a better   a different PFT. [In relation to caregiver assessments and caregiver reported outcomes] Sometimes the caregiver really knows   living with someone, I think you have a better perspective. And I think it would be valuable for you to get the caregiver’s opinion   because they are with them all the time. But before you start (pulmonary function tests), just say Jim, Mary, Tom, we have no idea where you are at. Just give us your best shot. You know what I mean? A little bit of a pep talk probably would not hurt. "
"There is 10 plus visits in a year   then at each visit, it is at least a two-hour visit   that is a fair amount of hard work as a patient. And I am just not sure that I would be up to that amount of work   I probably would still go forward with it   but having looked at what my requirements are for it, it is just dampened my enthusiasm of it. I am still going forward with it, I am just not as excited. Getting to the weekly visits can be difficult. My wife is in a wheelchair. I suffer from chronic fatigue   Questionnaires are taken at every visit so that is going to be a 30-minute function so I am not sure that, that needs to be done frankly. I think two hours would be probably the outer limit of length. I could do it, but I just think anything more than that is pushing it ... you are going to be dealing with people who are not always having a good day. There is a lot of blood tests ... And when I saw this, I thought, wow, that is a lot. And each time ... each time you get blood tests right for example. I was wondering about that and the blood test frequency, a little bit high I would say. When I saw this, I thought, wow, that is a lot. And each time ... each time you get blood tests, right for example. The total, the 52 weeks did not seem like a deal breaker but the greater the number I think the more people would find more onerous. Chronic fatigue syndrome: I only have five to six hours a day of energy to complete activities   so for me   the day is short for me. And chronic fatigue is common amongst ILD patients, so we got to think about that. Participants do not have to change their medications or how often they see their physician. If you have a big site   you may have to walk a mile   I can not do a mile   I do not typically have a wheelchair, but I might need one for that   it would be nice to get a shuttle from the parking lot, or get dropped off at a door, or something to know where I am going and how I could best get there. Either bus passes, or city transit, or parking   or the city passes, or   Uber credits or something along that line is good, because it is hard for some people to get around. As long as they are, I would say, probably morning to early afternoon [discussing visits] is better for most of the patients. His body starts shutting down probably by three in the afternoon. He starts going downhill. It would help that in working with the study coordinator, that they would have a little bit of flexibility. And if I would have a vacation planned [at] visit 6 that we could, we can move it out a week, but still be within that time period, and do something. So, we just have to see. So for instance, I do not know to change my time or the day of my visit, but as I say, I will do my best. I will do my best to stick to the visits that they will schedule for me. I am big on reminder emails   remind them of visits and remind them at this visit here is what we are going to do   just to set the expectation that it is going to take a while. And then   if there is anything that needs to be done beforehand. If you tell them up front   maybe that is a little bit helpful. If we had an agenda. If we had a schedule, I would feel less anguish. I would feel more safe. I would do whatever I needed to do, but I just thought it was much more reasonable than having to travel far, and the fact that you can do some things on the computer. I liked that. Yes, I would benefit indeed [from virtual visit option] because not all the days are the same. I guess the most positive thing is that it can be done from home. I prefer visits. Well, I prefer   the person I care for to undergo tests for better control, for better monitoring   But if visits were to be virtual, my scoring will not change. Because everything that has to be done through the computer is more difficult for me, so I would rather go to a place in person and get the tests done. I come from a different generation. I would expect them to tell me potential adverse events   long term adverse events. I would like them to let me know about them   I always take into account whether it will be detrimental as well for me in terms of adverse events. Maybe test results, anything to do with the test results in the trial   if the results could be sent to my PCP and be seen by my PCP as well, that would be great. Well, I guess that my primary care physician would like to hear about the   regular testing that I will be undergoing throughout the clinical trial   he refers me to other doctors   therefore it will be very important for him to know about those tests, the outcomes, the results, how those tests were done. Well the side effects, diarrhea. I was wondering about that   that really stuck in my mind in terms of concerns. [In the context of discussions about side effects] In principle, I would like to know everything   I would like to know if there has been secondary effects, I guess this has already been tried on humans. That is what I would like to know. More than the primary care, I think the pulmonologist would be the one who should be informed. The specialist   I think I would be telling him that I am getting a trial to see what his opinion is. Once I am in, I would like for him to have the tests and results at his disposal. It is a really good to have that person [discussing study care navigator] that you know you can always get a hold of because sometimes the doctor   is not available. So having that contact there that is always available   I think to navigate everything and again takes some of that stress level off of you. I think it is all about mental health and I am thinking about maybe a psychologist, psychological support, having some visits with a professional where she can really explain or share those concerns. I think it goes around the same idea of the peer group or being linked to this trial beyond just a medical fact, the fact that it is personally and psychologically giving her something. Well when you have a peer group you can feel more supported. Psychologically it is really helpful at least for me as a caretaker and for my mom as a patient to be able to share her experience with someone who is going through the same thing, I think that is very helpful. At least in studies that I have seen, I have never seen study partner caregiver compensation. I highly encourage it because they have costs, and they have skin in the game. I am just worrying if something like that happened, and he needs to be hospitalized, and he needed to be on more prednisone than he normally is ... I see that it is not permitted. No, the thing that worried me was, if he had to stop any of his meds that he was on now ... when I saw the list of meds, he would not have to stop any of his regular meds and be taking placebo. I was OK with that even if he was just taking placebo. We went to different hospitals, and they said it is a sequela of COVID and so we can not do anything with that. And they do not have any experience so we can not do anything. They say you are like this and that is how you are going to end up like. And you think, what is going to happen in between? Well, I am in the dark about what you can do to help the condition. Lack of information always causes more worries. If I was diagnosed with lung cancer it would have knocked me over, but knowing I have a fighting chance as things are, it is not bothering me. I was pleased it was not cancer. Doctors should be sensitive when delivering a diagnosis and prognosis to patients. The delivery of a diagnosis should not be rushed as the news is life changing. Time should not be an issue. If somebody says to you it is mild, moderate or severe, all that immediately goes through your mind is does that mean I have a short life or a long one? It does not tell you what you are faced with. It took me years to get diagnosed and I know this can isolate you so much because you just feel you need to know what is wrong with you so you can deal with it. It is extremely unsettling to have a disease that people say is rare and incurable. The research that I did on ILD was also hopeless pointing to low 5- and 10-year survival rates ... I had a lot of unanswered questions: How would my appearance change? Would I suffer? What other organs would be impacted after my lungs? What did I need to do to ensure the financial stability of my family? What did I need to do so that my family did not need me anymore? The diagnosis was communicated to me in a realistic manner. There is no treatment and no cure but – I remember the doctor emphasized that but – but there is a medicine that gives encouraging results. Being told you have this and there is nothing you can do is frightening. I was told that I was not suitable for transplant, so I felt in a position of no hope. I just had to sit down and take what was coming with no hope, and that was the worst of all. I was told my life expectancy was two to five years and then I was scheduled for a check-up for six months later. I was referred to a physiotherapist to learn breathing exercises. That was it – no other information or support was given. More thought should be given to the psychological impact of being diagnosed with this devastating disease. We were not given a lot of information. Most of what I learned was from attending a support group. I was told when the illness was diagnosed that it was terminal, which came as a shock to both me and my wife. I did not know what to do initially ... I tried looking at the internet and the information that was available managed to confuse me even more. I think at diagnosis, obviously, you need to be told that this is not curable and it is progressive and it will end your life. I think information can be provided in [the] way of a website, or even at the respiratory clinics, little leaflets for people to take. For example, having problems with exercise or keep healthy eating or, you know, when you are feeling down, these are the resources. [Information] should be available to you very early on, to put you onto the right track of exercise and diet. I think that [what] the website should include, is that you are not going to keel over from just exerting yourself a little bit. I was really frightened to do any exercise in case I made things worse. The missing link for patients is the lack of information among the GPs. They are not informed about the disease, and, in turn, they cannot properly advise patients or refer them to the right specialists. We knew nothing about pulmonary fibrosis when mum received her diagnosis and immediately researched it. Google was not kind and we could not believe something so cruel and terminal was unheard of. Anyone we spoke to about pulmonary fibrosis also had not heard about pulmonary fibrosis and we soon became educators. This really needs to change. There has to be more awareness and support for pulmonary fibrosis sufferers and their families. It was so hard to find information and any doctors or nurses we did talk to had never had a patient with IPF before. So what they maybe heard about or they were comparing it to COPD or other diseases that it really can not be compared to. There was no information and it was really hard to find, and it felt like we were completely on our own. From what I found online, it was scary; but I figured if that was the case, then her doctor would tell us. [In the context of advanced care planning and end-of-life care] I do not think the GP knows enough about IPF to be honest because in my experience, they have heard of it but they might have one patient with it but it seems like by the time people are diagnosed, they are too far gone; or it just seems like it is getting easier to diagnose ... Even the Palliative Care Nurse did not know about the oxygen testing and did not know about lung disease at all ... So I think they need to be more educated."
"Keep working with the doctors. I think a lot of the issues in the medical community is that it is still kind of an unknown disease. Especially in those smaller centers, where maybe the doctor has never seen this. I run everything through my GP first. So, once he found out that I have this, he did not know about it. And he told me, I have never had a patient like this before. I am going to learn all about this. And he spent the time learning. He learned on the journey with me, so that is pretty cool of my doctor. I believe it is important that healthcare professionals are honest with patients and families about the risks, so they can base their decisions on the facts. The support my father got was very good, especially from the specialist nurse who helped him to manage his condition. I have a good relationship with both the nurse and the respiratory therapist. They will decide on a plan, and then the nurse communicates with [the ILD physician] or [the rehabilitation/palliative respiratory care physician]. They handle all of that really well. We [patient and the nurse] had a conversation around this ... about how well our relationship is working. And I trust her [the nurse] implicitly to be communicative with [the ILD physician and the rehabilitation/ palliative respiratory care physician]. You have full involvement and knowledge in what is going on. It is very clear to us she is [the ILD physician] going to see us through to the end of this and it is her primary concern to do the best for us that she can. And that is a very good feeling—a feeling of trust and security. We are just feeling very lucky to have somebody like her and her entire group because they all have that same approach or philosophy to it all. We were terrified to have those conversations but once we knew for sure that was what was happening, we made it a point to talk about it openly and talk about her fears and concerns and that was huge. That was one thing that Dr. J nailed was being up front. What do you want your death to look like? How do you want to die? What scares you the most about it? And for my mom it was—she did not want to be drugged. She wanted to be conscious right until she could not be anymore so they kept that in mind. Do I just go into hospital and I just gasp until I die? But, being reassured by them that I can have a home death, there can be drugs that can help to calm me down, and people there ... Yes. And how caring and supportive the doctors can be. That there are drugs, medications that they can give you to calm you down, so it is not scary at the end. I ended up in hospital for a week on IV antibiotics and a chest tube. Plus they produced a Green Sleeve, which I would never seen or heard about until then. I can see their point. They want to get it done before you end up needing resuscitation. But honest to god if your are short of breath, got pains in your side and feeling lousy, it is not necessarily the time to be asking you questions about levels of care. And where you want to die and what the different types of experiences look like—so dying in a hospital versus a hospice versus at home. And with each of those different scenarios— the positives and negatives about it ... So it is really just about having those conversations and so people know what to expect and they are not blind-sided by it and making sure that the hospice is willing to work with them. And if they are going to stay at home, what resources are available to them? I think everything should be addressed   There is so many facets to a terminal disease that you do not even think about before your are diagnosed ... It is really hard ... By being honest. By laying it on the line and telling me this is what we do. This is what we can do. This is what could happen ... It is very important. It is one of my biggest fears. But now that I know a bit more about it, I go to a support group that Dr. J spoke about ... and I do feel much better just knowing. I was afraid of the end. Of how violent it could be. From things that I have heard   it was very calm and very reassuring. My hope is that oxygen companies will realize that oxygen needs are not a one size fits all across patients and will work more closely and compassionately with patients to ensure their oxygen needs can be met in a way that allows as much quality of life and as little frustration as possible. I know that since my transplant there has been great strides with new drugs to slow down the progression of IPF and research continues to find a cure. I only hope and pray that this will be made possible soon so the need for transplantation will lessen. There was a general lack of understanding of the condition is progression by GPs and others, and no services available to support patients and their families at the end of life. In my view, the health system let my mother, and us as a family, down badly at the end of her life, due to disjointed services, breakdowns in communication, and the fact that there was no one person to coordinate health and care services. It was truly a traumatic experience. I do feel that unlike cancer patients, pulmonary fibrosis sufferers do not receive the same emotional and mental support to help prepare them through the journey ... Explaining pulmonary fibrosis to anyone was a challenge  This really needs to change as it is deeply unfair and seems borderline discriminatory. Anyone going through pulmonary fibrosis needs to be supported and understood, just like any other terminal illness. Getting any support for mum was hard because it felt like her condition was not taken seriously until it became dire. My father died of pulmonary fibrosis when I was in college, and that was more than twenty years ago. In all those years, there is been no change in a patient is experience with the disease."
]

# Preprocess the text
docs = [doc.lower() for doc in documents]
docs = [''.join(c for c in doc if c not in string.punctuation) for doc in docs]
docs = [word_tokenize(doc) for doc in docs]

stop_words = set(stopwords.words('english'))
docs = [[word for word in doc if word not in stop_words] for doc in docs]

lemmatizer = WordNetLemmatizer()
docs = [[lemmatizer.lemmatize(word) for word in doc] for doc in docs]

# Create a dictionary and corpus
dictionary = Dictionary(docs)
corpus = [dictionary.doc2bow(doc) for doc in docs]

# Perform LDA
lda_model = LdaModel(corpus, num_topics=5, id2word=dictionary, passes=15)

# Display topics
topics = lda_model.print_topics(num_words=5)
for topic in topics:
    print(topic)
